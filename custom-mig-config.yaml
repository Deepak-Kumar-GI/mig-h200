apiVersion: v1
kind: ConfigMap
metadata:
  name: custom-mig-config
  namespace: gpu-operator
data:
  config.yaml: |
    version: v1
    mig-configs:
      custom-mig-config:
        # --- 1/7 SMs, 18GB VRAM per slice ---
        - devices: [7]
          mig-enabled: true
          mig-devices:
            "1g.18gb": 7

        # --- 1/7 SMs, 18GB VRAM + media extensions ---
        - devices: [6]
          mig-enabled: true
          mig-devices:
            "1g.18gb+me": 1
            "1g.18gb": 6

        # --- 1/7 SMs, 35GB VRAM per slice ---
        - devices: [5]
          mig-enabled: true
          mig-devices:
            "1g.35gb": 4

        # --- 2/7 SMs, 35GB VRAM per slice ---
        - devices: [4]
          mig-enabled: true
          mig-devices:
            "2g.35gb": 3

        # --- 2/7 SMs × 3 + 1/7 SMs × 1, 35GB each ---
        # Mixed medium + light inference. Fills GPU exactly:
        # 6/7 + 1/7 = 7/7 SMs, 6/8 + 2/8 = 8/8 memory.
        - devices: [3]
          mig-enabled: true
          mig-devices:
            "2g.35gb": 3
            "1g.35gb": 1

        # --- 3/7 SMs, 71GB VRAM per slice ---
        - devices: [2]
          mig-enabled: true
          mig-devices:
            "3g.71gb": 2

        # --- 4/7 + 3/7 SMs, 71GB VRAM each ---
        - devices: [1]
          mig-enabled: true
          mig-devices:
            "4g.71gb": 1
            "3g.71gb": 1
            
        # --- 7/7 SMs, full 141GB (bare-metal, no MIG) ---
        - devices: [0]
          mig-enabled: false
